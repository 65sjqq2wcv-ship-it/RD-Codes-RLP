<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Rettungsdienst Codes RLP</title>
    <meta name="description" content="Einsatzcode-Nachschlagewerk fÃ¼r Rettungsdienst RLP - ILS Landau" />

    <!-- Stylesheets -->
    <link rel="stylesheet" href="./styles.css" />
    <link rel="manifest" href="./manifest.json" />

    <!-- Icons -->
    <link rel="apple-touch-icon" href="./icons/icon-192x192.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="./icons/icon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="./icons/icon-16x16.png" />

    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="RD Codes RLP" />
    <meta name="mobile-web-app-capable" content="yes" />

    <!-- Theme Colors -->
    <meta name="theme-color" content="#DC2626" media="(prefers-color-scheme: light)" />
    <meta name="theme-color" content="#1E293B" media="(prefers-color-scheme: dark)" />
  </head>
  <body>
    <div class="app">
      <!-- Header -->
      <header>
        <div class="logo">
          <div class="logo-img">
            <img src="./logo.png" alt="Rettungsdienst Logo" class="logo-image">
          </div>
          <div class="header-content">
            <h1>RD Codes RLP</h1>
            <div class="version-info" id="version-info">v1.5</div>
          </div>
        </div>
        <div class="header-actions">
          <button id="config-icon" class="header-icon-btn" title="Konfiguration">
            âš™ï¸
          </button>
          <button id="info-icon" class="header-icon-btn" title="Info">
            â„¹ï¸
          </button>
        </div>
      </header>

      <main>
        <!-- Konfiguration Section -->
        <section class="config-section" id="config-section" style="display: none;">
          <h2>âš™ï¸ Konfiguration</h2>
          
          <div class="config-content">
            <!-- Aktuelle Konfiguration -->
            <div class="current-config">
              <h3>ğŸ“„ Aktuelle Datenquelle</h3>
              <div class="config-info" id="current-config-info">
                <div class="config-item">
                  <span class="config-label">Quelle:</span>
                  <span class="config-value" id="config-source">-</span>
                </div>
                <div class="config-item">
                  <span class="config-label">App-Version:</span>
                  <span class="config-value" id="app-version">-</span>
                </div>
                <div class="config-item">
                  <span class="config-label">Daten-Version:</span>
                  <span class="config-value" id="config-version">-</span>
                </div>
                <div class="config-item">
                  <span class="config-label">Letzte Aktualisierung:</span>
                  <span class="config-value" id="config-updated">-</span>
                </div>
                <div class="config-item">
                  <span class="config-label">Kategorien:</span>
                  <span class="config-value" id="config-categories">-</span>
                </div>
              </div>
            </div>

            <!-- Upload Section -->
            <div class="upload-section">
              <h3>ğŸ“ Neue Datei hochladen</h3>
              
              <!-- Desktop: Drag & Drop Area -->
              <div class="file-upload-area desktop-only" id="file-upload-area">
                <input 
                  type="file" 
                  id="file-input" 
                  accept=".json"
                  style="display: none;"
                />
                <div class="upload-content" id="upload-content">
                  <div class="upload-icon">ğŸ“„</div>
                  <div class="upload-text">
                    <strong>JSON-Datei hier ablegen oder klicken</strong>
                    <br><small>Nur .json Dateien werden akzeptiert</small>
                  </div>
                </div>
              </div>
              
              <!-- Mobile: Nur Info Area -->
              <div class="mobile-upload-area mobile-only" id="mobile-upload-area">
                <div class="upload-info">
                  <div class="upload-icon">ğŸ“„</div>
                  <div class="upload-text">
                    <strong>JSON-Konfigurationsdatei hochladen</strong>
                    <br><small>Nur .json Dateien werden akzeptiert</small>
                  </div>
                </div>
              </div>
              
              <!-- Action Buttons -->
              <div class="upload-actions">
                <button id="select-file-btn" class="btn-secondary">
                  ğŸ“ Datei auswÃ¤hlen
                </button>
                <button id="reset-to-default-btn" class="btn-secondary">
                  ğŸ”„ Standard wiederherstellen
                </button>
                <button id="download-current-btn" class="btn-secondary">
                  ğŸ’¾ Aktuelle Konfiguration herunterladen
                </button>
              </div>
            </div>

            <!-- Validation Result -->
            <div class="validation-result" id="validation-result" style="display: none;">
              <h3>âœ… Validierungsergebnis</h3>
              <div id="validation-details"></div>
            </div>
          </div>
        </section>

        <!-- Multi-Code-Suche Section -->
        <section class="multi-search-section">
          <h2>ğŸ” Code-Suche</h2>
          
          <div class="search-wrapper">
            <div class="search-input-container">
              <input 
                type="text" 
                id="multi-search" 
                placeholder="Codes oder Beschreibungen suchen (z.B. '237 268' oder 'Reanimation Schock')..."
                class="search-input multi-search-input"
                autocomplete="off"
              />
              <button id="clear-search-btn" class="clear-search-btn" title="Suche leeren" style="display: none;">
                âœ–ï¸
              </button>
            </div>
            <div class="search-help">
              ğŸ’¡ Mehrere Codes durch Leerzeichen trennen
            </div>
          </div>
          
          <!-- Suchergebnisse -->
          <div id="search-results" class="search-results" style="display: none;">
            <h3>ğŸ“‹ Gefundene Codes</h3>
            <div id="found-codes" class="found-codes">
              <!-- Gefundene Codes werden hier angezeigt -->
            </div>
            <div class="priority-assessment" id="priority-assessment">
              <!-- PrioritÃ¤tseinschÃ¤tzung wird hier angezeigt -->
            </div>
          </div>

          <!-- Alle Codes anzeigen wenn keine Suche -->
          <div id="all-codes-display" class="all-codes-display">
            <h3>ğŸ“– Alle verfÃ¼gbaren Codes</h3>
            <div id="all-codes-list" class="filtered-codes">
              <!-- Alle Codes werden hier angezeigt -->
            </div>
          </div>
        </section>

        <!-- Kategorie Ãœbersicht -->
        <section class="category-overview">
          <h2>ğŸ“š Kategorien</h2>
          <div class="category-grid" id="category-grid">
            <!-- Kategorien werden dynamisch geladen -->
          </div>
        </section>
      </main>
    </div>

    <!-- Info Modal -->
    <div id="info-modal" class="modal">
      <div class="modal-content">
        <h2>
          â„¹ï¸ Ãœber diese App
          <span class="close" id="info-modal-close">&times;</span>
        </h2>
        <div class="info-content">
          <h3>ğŸš‘ Rettungsdienst Codes RLP</h3>
          <p><strong>Konfigurierbare Code-Datenbank</strong></p>
          
          <h4>ğŸ“± Funktionen:</h4>
          <ul>
            <li>Multi-Code-Suche (leerzeichengetrennt)</li>
            <li>Case-insensitive Suche (GroÃŸ-/Kleinschreibung egal)</li>
            <li>Eigene JSON-Dateien hochladen</li>
            <li>Automatische PrioritÃ¤tsanalyse</li>
            <li>Farbkodierte Kategorien</li>
            <li>Offline-FunktionalitÃ¤t (PWA)</li>
            <li>Automatische App-Updates</li>
          </ul>

          <h4>ğŸ¯ Bedienung:</h4>
          <ol>
            <li>Eigene JSON-Datei Ã¼ber âš™ï¸ hochladen (optional)</li>
            <li>Codes in das Suchfeld eingeben (z.B. "237 268")</li>
            <li>Automatische Suche und Analyse</li>
            <li>Kategorien anklicken zum Filtern</li>
            <li>âœ–ï¸ zum Leeren der Suche oder ESC-Taste</li>
          </ol>

          <h4>ğŸ” Suchtipps:</h4>
          <ul>
            <li><strong>Mehrere Codes:</strong> "237 268 900"</li>
            <li><strong>Nach Text:</strong> "reanimation" oder "schock"</li>
            <li><strong>Gemischt:</strong> "237 reanimation"</li>
            <li><strong>GroÃŸ-/Kleinschreibung:</strong> egal - "NEF" = "nef"</li>
          </ul>

          <h4>ğŸ”„ Updates:</h4>
          <ul>
            <li>Die App prÃ¼ft automatisch auf Updates</li>
            <li>Sie werden benachrichtigt wenn eine neue Version verfÃ¼gbar ist</li>
            <li>Updates kÃ¶nnen sofort oder spÃ¤ter installiert werden</li>
            <li>Die App funktioniert auch offline (PWA)</li>
          </ul>

          <h4>ğŸ“„ JSON-Format fÃ¼r eigene Dateien:</h4>
          <pre><code>{
  "metadata": {
    "title": "Meine Codes",
    "version": "1.0", 
    "lastUpdated": "2024-01-15"
  },
  "categories": {
    "kategorie1": {
      "name": "Kategorie Name",
      "color": "#FF0000",
      "codes": {
        "100": "Code-Beschreibung",
        "101": "Weitere Beschreibung"
      }
    },
    "kategorie2": {
      "name": "Weitere Kategorie",
      "color": "#0000FF",
      "codes": {
        "200": "Anderer Code"
      }
    }
  }
}</code></pre>

          <h4>ğŸ¨ Empfohlene Kategoriefarben:</h4>
          <div class="color-examples">
            <div class="color-item">
              <span class="color-dot" style="background: #DC2626;"></span>
              <span>Herz-Kreislauf: #DC2626</span>
            </div>
            <div class="color-item">
              <span class="color-dot" style="background: #3B82F6;"></span>
              <span>Atmung: #3B82F6</span>
            </div>
            <div class="color-item">
              <span class="color-dot" style="background: #7C3AED;"></span>
              <span>Neurologisch: #7C3AED</span>
            </div>
            <div class="color-item">
              <span class="color-dot" style="background: #059669;"></span>
              <span>Internistisch: #059669</span>
            </div>
            <div class="color-item">
              <span class="color-dot" style="background: #F59E0B;"></span>
              <span>Trauma/Unfall: #F59E0B</span>
            </div>
            <div class="color-item">
              <span class="color-dot" style="background: #8B5CF6;"></span>
              <span>Sonstiges: #8B5CF6</span>
            </div>
          </div>

          <h4>âš™ï¸ Technische Details:</h4>
          <ul>
            <li>Progressive Web App (PWA) - installierbar</li>
            <li>Offline-FunktionalitÃ¤t durch Service Worker</li>
            <li>Automatisches Caching fÃ¼r schnelle Ladezeiten</li>
            <li>Responsive Design fÃ¼r alle GerÃ¤te</li>
            <li>Dark Mode UnterstÃ¼tzung</li>
          </ul>

          <div class="disclaimer">
            <strong>âš ï¸ Wichtiger Hinweis:</strong><br>
            Diese App dient nur als Nachschlagewerk und Hilfsmittel. 
            Sie ersetzt nicht die professionelle Ausbildung, 
            Erfahrung und das klinische UrteilsvermÃ¶gen im Rettungsdienst.
            Alle Angaben ohne GewÃ¤hr. Bei medizinischen NotfÃ¤llen 
            konsultieren Sie immer die aktuellen Leitlinien und 
            Behandlungsprotokolle Ihrer Organisation.
          </div>
        </div>
      </div>
    </div>

    <!-- Message Container fÃ¼r Toast-Nachrichten -->
    <div id="message-container"></div>
    
    <!-- Scripts -->
    <script src="app.js"></script>
  </body>
</html>
